// angular-slideshow - Copyright (c) 2015 by Daniel Schlessmann <info@eldanilo.de>
// License: http://www.opensource.org/licenses/mit-license.php

"use strict";angular.module("slideshow",[]).directive("slideshow",["$compile","$http","$timeout","$location",function(a,b,c,d){var e=function(b,d){var e=this;if(this.$scope=b,this.elem=d,this.handlers={onOrientationChange:function(a){e.handlers.onResize(a)},onResize:function(a){c(function(){e.$scope.$emit("stageResize")})},register:function(){"undefined"!=typeof window.orientation?window.addEventListener("orientationchange",this.onOrientationChange):window.addEventListener("resize",this.onResize)}},this.handlers.register(),this.animator={current:null,active:!1,timer:null,clearTimer:function(){},startTimer:function(){},loadSlide:function(a,b){this.active||(e.animator.active=!0,this.clearTimer(),e.$scope.slides[a].reset(),b||(e.$scope.slides[a].elem.style.left=0,e.$scope.slides[a].show()),this.startTimer(),this.current=a,this.active=!1)},handlers:{slideLoaded:function(a,b){b===e.animator.current&&e.animator.loadSlide(b)},register:function(){e.$scope.$on("slideLoaded",this.slideLoaded)}}},this.animator.handlers.register(),b.slides&&b.slides.length>0){this.animator.current=0;for(var f=0;f<b.slides.length;++f){var g=document.createElement("slide");g.setAttribute("data-slide-index",f),d.appendChild(g),a(g)(b)}}};return{restrict:"E",controller:["$scope",function(a){a.controller=this,a.slideshow=null,this.addSlide=function(b){"undefined"!=typeof b.index&&(a.slides[b.index]=b)}}],compile:function(a,b){return{pre:function(a,b,c,d){a.slideshow=new e(a,b[0])},post:function(a,b,c,d){}}},scope:{slides:"="}}}]).directive("slide",["$timeout",function(a){var b=function(a,b){var c=this;this.slide=a,this.elem=b,this.isSVG="svg"===b.nodeName.toLowerCase()?!0:!1,this.isLoading=!0,this.width=JustJS.dom.outerWidth(b),this.height=JustJS.dom.outerHeight(b),this.preserveRatio=!1;var d=b.className.match(/(?:^|\s)preserve-ratio-(\d+)(?:$|\s)/);null!==d&&(this.preserveRatio=parseInt(d[1])/100),this.handlers={onResize:function(a){c.resize()},register:function(){c.slide.$scope.$on("stageResize",this.onResize)}},this.handlers.register()};b.prototype.reset=function(){JustJS.dom.hasClass(this.elem,"center")&&(this.elem.style.marginTop=-Math.ceil(JustJS.dom.outerHeight(this.elem)/2)+"px",this.elem.style.marginLeft=-Math.ceil(JustJS.dom.outerWidth(this.elem)/2)+"px")},b.prototype.resize=function(){if(null!==typeof this.slide.$scope.slideshow){var a=this.slide.$scope.slideshow,b=JustJS.dom.innerWidth(a.elem),c=JustJS.dom.innerHeight(a.elem),d=JustJS.dom.outerWidth(this.elem),e=JustJS.dom.outerHeight(this.elem),f=b/d,g=c/e,h=Math.ceil(d*(g>f?f:g)),i=Math.ceil(e*(g>f?f:g)),j=null,k=null;return this.preserveRatio!==!1&&(j=Math.ceil(b*this.preserveRatio),k=Math.ceil(j*(this.height/this.width))),h>d&&(null!==j?j>d:!0)?(null!==this.preserveRatio&&h>j&&(h=j,i=k),h>this.width&&(h=this.width,i=this.height),d<this.width&&(this.elem.style.width=h+"px",this.elem.style.height=i+"px",d=h,e=i,this.reset())):(d>h||null!==j&&d>j)&&(null!==this.preserveRatio&&h>j&&(h=j,i=k),this.elem.style.width=h+"px",this.elem.style.height=i+"px",d=h,e=i,this.reset()),{width:d,height:e}}console.log("Slideshow: no valid slideshow instance present to perform resize.")};var c=function(c,d){var e=this;if(this.$scope=c,this.elem=d,this.index=d.hasAttribute("data-slide-index")&&/^\d+$/.test(d.getAttribute("data-slide-index"))?parseInt(d.getAttribute("data-slide-index")):null,this.objects=[],this.loading=0,this.animator={},this.handlers={imageLoaded:function(c){e.elem.appendChild(c),e.objects.push(new b(e,c)),0===--e.loading&&a(function(){e.$scope.controller.addSlide(e),e.$scope.$emit("slideLoaded",e.index)})},register:function(){}},this.handlers.register(),null!==this.index&&c.slides[this.index].objects)for(var f=0;f<c.slides[this.index].objects.length;++f){var g=c.slides[this.index].objects[f];switch(g.type){case"img":++this.loading;var h=document.createElement("img");h.onload=function(){e.handlers.imageLoaded(h)},h.alt=g.alt,h.className=g.classes,h.src=g.src;break;case"svg":}}};return c.prototype.reset=function(){for(var a=0;a<this.objects.length;a++)this.objects[a].reset()},c.prototype.show=function(){},{restrict:"E",require:"^slideshow",controller:["$scope",function(a){}],compile:function(a,b){return{pre:function(a,b,d,e){new c(a,b[0])},post:function(a,b,c,d){}}}}}]);
//# sourceMappingURL=angular-slideshow.min.js.map